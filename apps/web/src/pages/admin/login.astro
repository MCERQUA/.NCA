---
export const prerender = false; // Server-render this page

import BaseLayout from '../../layouts/BaseLayout.astro';
import { Card, CardHeader, CardTitle, CardDescription, CardContent } from '../../components/ui/Card';

// Simple admin credentials (in production, use proper auth)
const ADMIN_USERNAME = 'admin';
const ADMIN_PASSWORD = 'nca2024admin'; // Change this!
---

<BaseLayout title="Admin Login - NCA">
  <main class="min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4">
    <div class="w-full max-w-md">
      <div class="text-center mb-8">
        <h1 class="text-3xl font-heading font-bold text-charcoal mb-2">
          Admin Dashboard
        </h1>
        <p class="text-slate">
          Sign in to manage contractor applications
        </p>
      </div>

      <!-- Error Message -->
      <div id="error-message" class="hidden mb-6">
        <Card className="border-red-500 bg-red-50">
          <CardContent className="p-4">
            <p class="text-red-800 text-sm" id="error-text"></p>
          </CardContent>
        </Card>
      </div>

      <Card>
        <CardHeader>
          <CardTitle>Sign In</CardTitle>
          <CardDescription>Enter your credentials to access the admin panel</CardDescription>
        </CardHeader>
        <CardContent className="p-6">
          <form id="login-form" class="space-y-4">
            <div>
              <label for="username" class="block text-sm font-medium text-gray-700 mb-2">
                Username
              </label>
              <input
                type="text"
                id="username"
                name="username"
                required
                autocomplete="username"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
                placeholder="admin"
              />
            </div>

            <div>
              <label for="password" class="block text-sm font-medium text-gray-700 mb-2">
                Password
              </label>
              <input
                type="password"
                id="password"
                name="password"
                required
                autocomplete="current-password"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
                placeholder="••••••••"
              />
            </div>

            <button
              type="submit"
              class="w-full bg-primary text-white font-semibold py-3 px-6 rounded-lg hover:bg-primary-600 transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"
            >
              Sign In
            </button>
          </form>
        </CardContent>
      </Card>
    </div>
  </main>

  <script define:vars={{ ADMIN_USERNAME, ADMIN_PASSWORD }}>
    const form = document.getElementById('login-form');
    const errorMessage = document.getElementById('error-message');
    const errorText = document.getElementById('error-text');

    form?.addEventListener('submit', (e) => {
      e.preventDefault();

      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
        // Set session (using sessionStorage for simplicity)
        sessionStorage.setItem('admin_authenticated', 'true');
        window.location.href = '/admin/dashboard';
      } else {
        errorText.textContent = 'Invalid username or password';
        errorMessage.classList.remove('hidden');
      }
    });
  </script>
</BaseLayout>
